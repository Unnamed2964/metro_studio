# RailMap — 轨道交通线路图编辑器

## 产品定位

面向轨道交通爱好者的线路图编辑与绘制工具。用户可以在地理底图上绘制地铁/轻轨线网，管理线路、站点、换乘关系，并通过示意图视图、车载HUD视图、时间线动画等多种方式呈现作品。

核心用户画像：轨道交通爱好者——他们画线路图是出于热爱，追求的是画图过程的流畅和成品的美观，而非专业规划产出。

## 技术栈

- Vue 3 (Composition API) + Vite
- Pinia 状态管理，按职责拆分为 14 个 action 模块
- MapLibre GL 地图渲染 + OSM 瓦片
- Canvas 2D 时间线动画渲染
- Web Worker 自动布局计算
- IndexedDB 本地持久化（idb）
- OpenAI 兼容 API 的 AI 辅助功能

## 开发方向

### 近期优先

1. **编辑体验打磨** — 这是核心竞争力。地图编辑器的交互流畅度、操作直觉性、视觉反馈是最高优先级。包括但不限于：
   - 选择、拖拽、绘制等基础操作的手感优化
   - 撤销/重做的可靠性和视觉反馈
   - 批量操作的便捷性（多选编辑、批量重命名等）
   - 键盘快捷键的完善和可发现性

2. **示意图质量提升** — 示意图是用户最终成品的主要形态，需要持续提升渲染质量：
   - 自动布局算法的优化（更接近官方示意图的美感）
   - 标签放置的智能避让
   - 更多样式选项（线宽、字体、间距等可调参数）

3. **导出能力增强** — 让用户能把作品带走和分享：
   - 时间线视频导出（引擎已实现，需要暴露到 UI）
   - PDF 导出
   - 更高质量的 PNG/SVG 输出选项

### 中期方向

4. **HUD 视图通用化** — 当前硬编码了济南地铁品牌元素，需要支持自定义品牌/样式，让任何城市的线网都能生成对应的车载HUD。

5. **AI 辅助功能扩展** — AI 的定位是辅助性工具，不是核心卖点。当前已有站点命名和英文翻译，保持这个方向：
   - 改善 AI 配置体验（连接测试、错误提示）
   - 探索更多轻量辅助场景（如颜色推荐、命名风格一致性检查）

6. **数据互通** — GeoJSON 导入/导出、项目模板、与其他工具的数据交换。

### 长期愿景

7. **性能与规模** — 支持超大线网（1000+ 站点）的流畅编辑，虚拟滚动、渲染优化等。

8. **时间线功能完善** — 时间线拖拽跳转、动画预设、更丰富的事件编辑。

## 开发规范

### 代码质量

- 不 mock，不简化实现，不做"先跑起来再说"的妥协。禁止 MVP 思维。
- 不做假设，不确定的地方询问用户。
- 使用频繁更新的库时，先搜索互联网获取最新 API 文档。
- 代码变更必须同步更新对应目录的 README.md，保证文档与实现一致。
- 过长文件分块写入。

### 用户体验原则

- 用户体验是最高优先级的技术决策依据。
- 交互要直觉化——用户不应该需要看说明书才能上手。
- 视觉反馈要即时——每个操作都应该有清晰的响应。
- 错误处理要优雅——不让用户看到技术性的错误信息，给出可操作的提示。
- 性能是体验的一部分——卡顿就是 bug。

### AI 使用边界

- AI 功能定位为辅助工具，用于站点命名、英文翻译等轻量任务。
- 不做 AI 生成线网、AI 规划路线等重型功能。
- AI 调用必须有超时、中断、错误回退机制。
- AI 配置（API key、模型选择）由用户自行管理。