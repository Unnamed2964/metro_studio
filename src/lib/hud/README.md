# lib/hud 目录说明

- `renderModel.js`
  - 从工程数据中提取指定线路的主路径，并自动生成方向选项（常规线路为双向“开往终点”，环线为正/反向）。
  - 对线路拓扑执行主通路求解：
    - 自动过滤无效边与孤立分量
    - 非环线优先按端点最远距离求主干路径
    - 环线在满足简单环条件时按环顺序生成全站序列
    - 部分环线（存在环但非“所有站点度数=2”的纯环）保留主路径方向解算，同时标记为闭合渲染
  - 生成车辆 HUD 渲染模型：
    - 站序、线条主路径、终点方向文本（当前视图不再渲染顶部头部横条）
    - 换乘标识（双圈换乘图标：加粗外环 + 内圈 + 倒三角标 + `换乘/Transfer` + 多线路牌；线路牌直接显示真实线路名，如 `2号线`、`济阳线`、`云巴1号线`，仅展示非当前线路；三角标颜色跟随首个换乘线路；线路牌矩形采用放大尺寸；且始终位于站名文字的另一侧）
    - 上侧换乘块自动抬高线路牌并拉开 `换乘/Transfer` 间距，避免英文被线路牌遮挡
    - 站名锚点整体上移，降低与轨道和站圈的视觉冲突
    - 换乘线路识别使用统一线路 ID 键（兼容字符串/数字 ID），避免本线被误显示为换乘线
    - 站名标签使用水平排版（角度 `0`），并保留离线偏移避免压线（如 `山东职业学院 / Shandong Vocational College`）
    - 段间方向箭头（双箭头标记）
    - HUD 非环线短线采用紧凑画布缩放（避免短线场景元素过小）；整体仍保留宽度自适应策略
    - 轨道左右留白增大，降低首末站长站名超出面板的概率
    - 环线布局渲染：纯环与部分环线在站点数满足条件时均按双层闭合轨道排布（上下两层，左右端首尾连接）
    - 超长线路单次折返（约 `30` 站阈值，两排 + 右侧单弯连接，且上下排间距按换乘块高度自适应增大，避免上下换乘标识冲突）
    - 未折返时 HUD 宽度按站点数自适应，并限定最小/最大宽度，兼顾短线可读性与长线密度
- `jinanBrand.js`
  - 济南地铁品牌矢量资源常量（Logo 路径与颜色），供 HUD 预览与导出复用
