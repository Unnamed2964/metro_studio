# stores 目录说明

该目录存放 Pinia Store。

- `projectStore.js`
  - 工程生命周期（初始化、新建、加载、持久化）
  - 工程管理器能力（当前工程重命名、复制、按 ID 删除并自动回退）
  - OSM 导入触发与状态回填
  - 地图编辑动作（加站、连线、拖拽更新、批量拖拽）
  - 连续布线状态管理（`route-draw` 模式下维护待连接起点并连续追加线段）
  - 站点选择状态管理（单选/多选/框选结果回填）
  - 站点重命名（单站 + 模板批量重命名）、批量删除
  - 线段选择与删除
  - 线段锚点编辑（新增、拖拽更新、删除、清空），并通过 `isCurved` 标记控制仅手动锚点线段启用曲线渲染
  - 站点移动时自动同步线段端点坐标，保持线段与站点连接
  - 编辑线段时会按端点自动校正 `waypoints` 方向，避免反向点序引发锚点与折线错位
  - 线路编辑（名称、颜色、状态、线型、环线标记）
  - 删除线路时会清理仅属于该线路且删除后无线路归属的站点；仍被其他线路使用的换乘站保留
  - 环线命名规范化（自动去除“从哪到哪”后缀）
  - 站点线路归属重算时，保留无归属线路站点的显式在建/规划标记（用于 OSM 独立站点导入场景）
  - 自动排版调用（含 `layoutMeta` 回填：标签锚点、边方向）
  - 自动排版参数管理（`layoutConfig.geoSeedScale`，支持 UI 滑块动态调整并持久化）
  - 导出动作（实际走向图 PNG 通过真实地图组件导出器、官方风格图 PNG、车辆 HUD ZIP）与工程文件读写
  - 导出设置状态（车站显示策略：仅作用于“实际走向图 PNG”，支持全部/仅换乘/隐藏）
  - UI 状态管理（模式、选中态、状态文本）

